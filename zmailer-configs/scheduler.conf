# Do not edit this file, instead edit /home/polaris/mea/src/zmailer/proto/scheduler.conf
#
# Scheduler configuration file
#
# The scheduler reads this file on startup or when it receives a SIGUSR1 signal
#
# Every channel/host combination in recipient addresses will be sifted through
# the clauses matched in this file, picking up parameters until a clause that
# specifies a command.  Everything is free-form with three requirements:
# Clauses (i.e. the channel/host pattern) start at the beginning of a line.
# Clause contents (i.e. the parameters) don't.
# Components are separated by whitespace.
# NB! For command paths, the "current directory" is MAILBIN/ta

# Boilerplate default parameters
*/*		interval=1m
		# expire messages after 3 days without full delivery
		expiry=3d
		# when the scheduler gets to the end of the retry sequence,
		# it starts over at some random point in the middle.  The
		# numbers are factors of the scheduling interval.
		retries="1 1 2 3 5 8 13 21 34"
		# no default limits on simultaneous transport agents or
		# connections to a particular host
		maxchannel=0
		maxhosts=0
		#
		maxta=250 # SunOS has a limit of 256 FDs, don't overbook..
		#
		# skew is maximum number of tries before the retry time is
		# aligned to a standard boundary (seconds modulo interval).
		skew=1
		# default uid/gid of transport agents
		user=root
		group=daemon

# This is a FAST EXPIRY test case.. Will always cause bounce, btw..
smtp/*-gw.funet.fi
		maxchannel=0
		maxhosts=1
		expiry=1m
		interval=15s
		retries="1"
		skew=1
		command="smtp -sl /var/log/mail/smtp $host"

# Within FUNET we have a bit longer expiry..
smtp/*funet.fi
		maxchannel=199
		maxhosts=1
		# maxta=2
		expiry=14d
		interval=10m
		retries="1 1 2 3 5 8 13 21 34"
		skew=1
		gangschedule
		byhost
		# Do FORCED MIME-decoding into C-T-E: 8BIT
		command="smtp -8sl /var/log/mail/smtp $host"

# Within our organization we care more about speed and capacity than connections
# The maxchannel value should be larger than the value used by smtp/*, to avoid
# some potential state and phase problems in the queues.
smtp/*.fi
		maxchannel=199
		maxhosts=2
		# maxta=4
		interval=10m
		retries="1 1 2 3 5 8 13 21 34"
		skew=1
		gangschedule
		byhost
		command="smtp -sl /var/log/mail/smtp $host"

# Connections to the outside shouldn't duplicate effort so we only allow one
# per destination.
smtp/*
		maxchannel=199
		# maxta=25
		maxhosts=1
		gangschedule
		byhost
		command="smtp -sl /var/log/mail/smtp $host"

# Error messages.  Delivery can be retried at leisure.
error/*		interval=5m
		maxchannel=10
		command=errormail

# UUCP delivery.  The "sm" transport agent picks the first host it sees and
# will select further recipient addresses with that host only.  We tell
# the scheduler this with the "byhost" boolean, to avoid a staggered delivery
# effect if the scheduler has to discover this on its own.
uucp/*		maxchannel=5
		byhost
		command="sm -8c $channel uucp"

# News delivery.  Hostname is always the same here.
usenet/*	maxchannel=2
		command="sm -8c $channel usenet"

# UBC EAN X.400 gateway.  See comment at UUCP.
ean/*		maxchannel=1
		byhost
		command="sm -c $channel ean"

# Deferred delivery is handled by this transport agent.  Deferrals are low
# priority, but they tend to bunch up.  The 1 channel slot means there will
# be lots of contention, and typical checking intervals will be a bit higher
# than what is specified (due to waiting for a free slot).
hold/*		interval=5m
		maxchannel=1
		command=hold

# BITNET delivery methods

defrt1/*
		maxchannel=3
		maxhosts=1
		command="sm -c $channel defrt1"

bsmtp3/*
		maxchannel=3
		maxhosts=1
		command="sm -c $channel bsmtp3"

bsmtp3nd/*
		maxchannel=3
		maxhosts=1
		command="sm -c $channel bsmtp3nd"
bsmtp3rfc/*
		maxchannel=3
		maxhosts=1
		command="sm -c $channel bsmtp3"

bsmtp3ndrfc/*
		maxchannel=3
		maxhosts=1
		command="sm -c $channel bsmtp3nd"

# Local delivery: user mail, files, processes
local/*
		interval=10s
		expiry=3h
		maxhosts=20
		# want 2 channel slots in case of blockage on one
		maxchannel=2
		byhost
		# maxta=4
		#
		# Do MIME text/plain; Quoted-Printable -> text/plain; 8BIT
		# conversion on flight!
		command="mailbox -8 -h $host"
